generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Halls {
  id          Int          @id @default(autoincrement())
  hallName    String
  hallAddress hallAddress?
  capacity    Int
  Movies      Movie[]
  Booking     Booking[]
  seats       Seat[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model hallAddress {
  id         Int     @id @default(autoincrement())
  street     String?
  city       String?
  state      String?
  postalCode String?
  country    String?
  hallId     Int     @unique
  hall       Halls?  @relation(fields: [hallId], references: [id])
}

model Seat {
  id         Int     @id @default(autoincrement())
  seatNumber Int
  available  Boolean @default(true)

  hallId Int
  hall   Halls @relation(fields: [hallId], references: [id])

  Booking Booking?

  @@unique([seatNumber, hallId])
}

model Movie {
  id          Int      @id @default(autoincrement())
  movieName   String
  duration    Int
  releaseDate DateTime

  hallId Int
  hall   Halls @relation(fields: [hallId], references: [id])

  Booking Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model User {
  id          String    @id @default(cuid())
  firstName   String
  lastName    String?
  email       String?   @unique
  phoneNumber String    @unique
  password    String
  Address     Address?
  Booking     Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Address {
  id         Int     @id @default(autoincrement())
  street     String?
  city       String?
  state      String?
  postalCode String?
  country    String?
  userId     String  @unique
  user       User?   @relation(fields: [userId], references: [id])
}

model Booking {
  id Int @id @default(autoincrement())

  hallId Int
  hall   Halls @relation(fields: [hallId], references: [id])

  movieId Int
  movie   Movie @relation(fields: [movieId], references: [id])

  userId String
  user   User   @relation(fields: [userId], references: [id])

  seatNumber Int
  seatHallId Int
  seat       Seat @relation(fields: [seatNumber, seatHallId], references: [seatNumber, hallId])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([seatNumber, seatHallId])
}
